<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>ZenTab Dashboard</title>
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="stylesheet" href="css/options.css">
</head>
<body>

<!-- Navigation Rail -->
<nav class="sidebar">
    <div class="logo">ZenTab</div>

    <div class="nav-links">
        <button id="nav-dashboard" class="nav-btn active" data-target="view-dashboard">
            Dashboard
        </button>
        <button id="nav-settings" class="nav-btn" data-target="view-settings">
            Settings
        </button>
    </div>
</nav>

<!-- Main Content Area -->
<main class="content-area">

    <!-- VIEW: DASHBOARD (Saved Tabs) -->
    <section id="view-dashboard" class="view-section active">
        <div class="view-header">
            <h1>Your Workspace History</h1>
            <div class="header-actions">
                <!-- Search Bar -->
                <input type="text" id="dashboard-search" class="input-dark" placeholder="Search saved tabs...">
                
                <!-- Action Buttons -->
                <button id="btn-dedupe" class="btn-secondary" title="Remove duplicate URLs across all groups">Clean Duplicates</button>
                <button id="clear-all" class="btn-delete-all">Delete Everything</button>
            </div>
        </div>

        <div id="container"></div>
    </section>

    <!-- VIEW: SETTINGS -->
    <section id="view-settings" class="view-section" style="display:none;">
        <h1>Settings</h1>

        <div class="settings-grid">

            <!-- Column 1: Domain Filtering -->
            <div class="settings-card">
                <h3>Domain Filtering</h3>
                <p style="margin-bottom: 20px;">Control which sites are allowed to be saved.</p>

                <div class="control-group">
                    <select id="mode-select" class="mode-select">
                        <option value="blacklist">Blacklist (Block Specific)</option>
                        <option value="whitelist">Whitelist (Allow Specific)</option>
                    </select>
                    <p id="mode-desc" class="setting-hint" style="margin-top:5px;">Only sites NOT in this list will be saved.</p>
                </div>

                <div class="add-row">
                    <input type="text" id="add-input" class="input-dark" placeholder="example.com">
                    <button id="add-btn" class="btn-add">+</button>
                </div>

                <input type="text" id="search-input" class="input-dark" placeholder="Search domains...">

                <div id="domain-list"></div>
            </div>

            <!-- Column 2: General & Backups -->
            <div class="right-col">

                <div class="settings-card">
                    <h3>General Preferences</h3>
                    
                    <!-- Favicons -->
                    <div class="setting-group">
                        <div class="setting-row">
                            <label for="setting-favicons">Show Website Icons</label>
                            <input type="checkbox" id="setting-favicons">
                        </div>
                    </div>
                    
                    <div class="divider"></div>

                    <!-- Focus on Open (New) -->
                    <div class="setting-group">
                        <div class="setting-row">
                            <label for="setting-focus">Switch to Tab on Open</label>
                            <input type="checkbox" id="setting-focus">
                        </div>
                    </div>

                    <div class="divider"></div>

                    <!-- Consume on Open -->
                    <div class="setting-group">
                        <div class="setting-row">
                            <label for="setting-consume">Open and Remove</label>
                            <input type="checkbox" id="setting-consume">
                        </div>
                        <p class="setting-hint">
                            When you click a link in the dashboard, it will be removed from the saved list immediately.
                        </p>
                    </div>
                    
                    <div class="divider"></div>

                    <!-- Auto Dedupe -->
                    <div class="setting-group">
                        <div class="setting-row">
                            <label for="setting-dedupe">Auto-remove Duplicates</label>
                            <input type="checkbox" id="setting-dedupe">
                        </div>
                        <p class="setting-hint">
                            When saving new tabs, automatically remove older copies of the same URL from unpinned groups.
                        </p>
                    </div>
                </div>

                <!-- ZenTab Native Backups -->
                <div class="settings-card">
                    <h3>ZenTab Backup (JSON)</h3>
                    <p class="setting-hint" style="margin-bottom: 15px;">Full backup including settings and timestamps.</p>

                    <!-- Manual Actions -->
                    <div class="backup-actions">
                        <button id="btn-export-now" class="btn-primary">
                            Download Full Backup (JSON)
                        </button>

                        <div style="margin-top: 10px; display: flex; gap: 10px;">
                            <input type="file" id="import-file" accept=".json" style="display:none">
                            <button id="btn-import-trigger" class="btn-secondary">
                                Import Full Backup
                            </button>
                        </div>
                        <p id="import-status" style="font-size: 0.85em; color: var(--accent-green); display:none; margin-top:5px;"></p>
                    </div>

                    <div class="divider" style="margin: 20px 0;"></div>

                    <!-- Automation -->
                    <div class="backup-config">
                        <div class="setting-group">
                            <div class="setting-row">
                                <label for="backup-enabled">Auto-save to Downloads</label>
                                <input type="checkbox" id="backup-enabled">
                            </div>
                        </div>

                        <div id="auto-backup-options" class="auto-options">
                            <label>Frequency:</label>
                            <div class="input-group">
                                <input type="number" id="backup-val" class="input-dark small" min="0.1" step="0.1" value="1">
                                <select id="backup-unit" class="input-dark">
                                    <option value="hours">Hours</option>
                                    <option value="days">Days</option>
                                    <option value="weeks">Weeks</option>
                                </select>
                            </div>
                            <p class="setting-hint" style="margin-top:8px;">
                                Backups will be saved to your browser's default download location.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- OneTab / Text Compatibility -->
                <div class="settings-card">
                    <h3>Import / Export URLs</h3>
                    <p class="setting-hint" style="margin-bottom: 10px;">OneTab compatible. Copy/Paste a list of URLs (one per line).</p>

                    <textarea id="onetab-io" class="input-dark" rows="6" placeholder="https://example.com | Example Title&#10;https://google.com"></textarea>

                    <div class="backup-actions" style="margin-top:15px; display:flex; gap:10px;">
                        <button id="btn-onetab-import" class="btn-secondary" style="background-color: var(--accent-green); color: var(--bg-base); border:none;">
                            Import List
                        </button>
                        <button id="btn-onetab-export" class="btn-secondary">
                            Generate Export List
                        </button>
                    </div>
                    <p id="onetab-status" class="setting-hint" style="margin-top:5px;"></p>
                </div>

            </div>

        </div>
    </section>

</main>

<script type="module" src="options.js"></script>
</body>
</html>